Описание взаимодействия CALL-центра и Медиалог.txt
=============================================================
Чтобы Медиалог отреагировал на получение звонка, необходимо, чтобы:
1. В каталоге "Medialog\PRIVATE" был создан файл CISCO_CALL.INI с
записями параметров звонка в след. формате:
ИМЯ_ПОЛЯ=ЗНАЧЕНИЕ_ПАРАМЕТРА
где ИМЯ_ПОЛОЯ - это имя поля в таблице CALLS в БД Медиалог, а
ЗНАЧЕНИЕ_ПАРАМЕТРА - текстовое значение параметра звонка (напр номер
телефона, CALLER_ID и т. д.)

2. Главному окну Медиалога было послано сообщение 1803 (HEX 70B),
например вот таким вызовом
PostMessage(hwndMedialog, WM_USER + 779, 0, 0) функции Windows API
(WM_USER + 779 = 1803).
Переменная hwndMedialog - handle главного окна Медиалога, его можно
найти, например, вот так:
hwndMedialog := FindWindow(PChar('TfMain'), nil);

Получив это сообщение, Медиалог обработает файл CISCO_CALL.INI, выполнит необходимые
действия по регистрации звонка и удалит файл.

Пример содержимого файла CISCO_CALL.INI:
PHONE=123-43-22
CALL_UID=9004320
=============================================================

А вот описание использования самого CISCOSRV.EXE:
=============================================================
Утилита интеграции Медиалога с CISCO CallCenter - CISCOSrv.exe
Настройки она в принципе не требует - при отсутствии настроечного
файла CISCOSrv.INI он создастся при первом запуске с настройками по
умолчанию (№ телефона и UID звонка). Передаваемых параметров может
быть меньше чем в настроечном файле (например, только номер телефона)-
это не страшно.

Вот краткое ее описание:
  CISCOSrv.exe - консольное приложение, которое принимает на входе в
параметрах командной строки № телефона и UID звонка (возможна передача
и другой информации) и передает ее в Медиалог через файл.
CISCOSrv.exe сохраняет эту информацию в буферный текстовый файл в следующем виде:
Имя поля=Значение, взятое из параметра.
  При этом есть файл настроек CISCOSrv.INI, в котором прописывается
соответствие параметров полям:
Имя поля=№ параметра командной строки.
После создания файла CISCOSrv.exe уведомляет об этом Медиалог, посылая
главному окну фксированный wm_message.
Пример вызова консольного приложения: CISCO_srv.exe 123-43-22 9004320
  Файл CISCOSrv.exe должен находится в рабочем каталоге - том же
каталоге, где и Automedi.exe. Буферный файл будет создаваться в
подкаталоге PRIVATE рабочего каталога с именем CISCO_CALL.INI.
Для того, чтобы CISCO Agent нашел CISCOSrv.exe, необходимо, чтобы путь
к утилите был в переменной окружения PATH.

  При получении сообщения от CISCOSrv.exe Медиалог открывает окно
регистрации нового звонка и заполняет поля информацией из буферного текстового файла.
=============================================================